/**
 * Shared type definitions for the entire application
 * Defines common data structures used across modules
 * Uses TypeScript types exclusively (no interfaces) per project standards
 */

import {z} from 'zod';

/**
 * Stock data point with date information
 */
export const StockDataPointSchema = z.object({
	date: z.string(),
	open: z.number(),
	high: z.number(),
	low: z.number(),
	close: z.number(),
	volume: z.number(),
	adjClose: z.number(),
});

/**
 * API configuration
 */
export type ApiConfig = {
	rateLimit: number;
	retries: number;
	timeout: number;
};

/**
 * Prediction result for a stock symbol
 */
export type PredictionResult = {
	confidence: number;
	currentPrice: number;
	days: number;
	fullHistory: StockDataPoint[];
	historicalData: StockDataPoint[];
	meanAbsoluteError: number;
	percentChange: number;
	predictedData: {date: string; price: number}[];
	predictedPrice: number;
	predictedPrices: number[]; // Added back for compatibility
	predictionDate: Date;
	priceChange: number;
	symbol: string;
};

/**
 * Report prediction data
 */
export type ReportPrediction = {
	confidence: number;
	name: string;
	prediction: PredictionResult;
	signal: TradingSignal['action'];
	symbol: string;
};

export type StockDataPoint = z.infer<typeof StockDataPointSchema>;

/**
 * Trading configuration
 */
export type TradingConfig = {
	buyThreshold: number;
	minConfidence: number;
	sellThreshold: number;
};

/**
 * Trading signal generated by prediction engine
 */
export type TradingSignal = {
	action: 'BUY' | 'HOLD' | 'SELL';
	confidence: number;
	delta: number; // Added back for compatibility
	reason: string; // Added back for compatibility
	symbol: string;
	timestamp: Date;
};

/**
 * Yahoo Finance Quote response schema
 */
export const YahooQuoteSchema = z.object({
	regularMarketPrice: z.number(),
	currency: z.string(),
	longName: z.string().optional(),
	shortName: z.string().optional(),
});
